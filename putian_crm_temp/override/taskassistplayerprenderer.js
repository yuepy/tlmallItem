/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2015 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET99 */
if(typeof(SiebelAppFacade.TaskAssistPlayerPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.TaskAssistPlayerPR");define("siebel/taskassistplayerprenderer",["siebel/basephyrenderer"],function(){SiebelAppFacade.TaskAssistPlayerPR=(function(){var v=SiebelJS.Dependency("SiebelApp.Constants");var L=SiebelJS.Dependency("SiebelApp.Utils");var s=false;var t=false;var D=-1;var F;function h(M){SiebelAppFacade.TaskAssistPlayerPR.superclass.constructor.call(this,M)}SiebelJS.Extend(h,SiebelAppFacade.BasePR);h.prototype.Init=function(){SiebelAppFacade.TaskAssistPlayerPR.superclass.Init.call(this);this.AttachPMBinding("Show",g,{scope:this});this.AttachPMBinding("PlayerMode",G,{scope:this});this.AttachPMBinding("TaskListName",H,{scope:this});this.AttachPMBinding("LocaleStringMap",K,{scope:this});this.AttachPMBinding("Tasks",e,{scope:this});this.AttachPMBinding("TaskDetail",f,{scope:this});this.AttachPMBinding("ReturnLinkName",d,{scope:this});this.AttachPMBinding("ClearCurrentStepControlsHighlight",E,{scope:this})};h.prototype.ShowUI=function(){SiebelAppFacade.TaskAssistPlayerPR.superclass.ShowUI.call(this);var N=$("#s_TaskAssistant").parent();var M=N.siblings("a.next-item-applet").attr("title")+" "+SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_FORM_APPLET");N.attr({role:"region",title:M});$("#s_taclose").attr("role","button").attr("tabindex","0").attr("aria-label",this.GetPM().Get("LocaleStringMap").IDS_TASKASST_CLOSE);$("#TaskAssistant").attr("role","application")};h.prototype.BindEvents=function(){SiebelAppFacade.TaskAssistPlayerPR.superclass.BindEvents.call(this);var M=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");if(M){var O=$("#TaskAssistant #s_taclose");var N=$("#TaskAssistant #s_tadone");if(O.length){M.Manage(O,"click",{ctx:this},c);M.Manage(O,"keydown",{ctx:this},a)}if(N.length){M.Manage(N,"click",{ctx:this},z);M.Manage(N,"keydown",{ctx:this},k)}}};h.prototype.BindData=function(){SiebelAppFacade.TaskAssistPlayerPR.superclass.BindData.call(this);if(this.GetPM().Get("PlayerMode")===null){this.GetPM().ExecuteMethod("LoadAllData")}else{G.call(this);H.call(this);K.call(this);if(this.GetPM().Get("PlayerMode")==="0"){e.call(this)}else{f.call(this)}}};h.prototype.EndLife=function(){if(s){x.call(this,false);SiebelApp.EventManager.removeListner("postload",this.HighlightControls,this);s=false}SiebelAppFacade.TaskAssistPlayerPR.superclass.EndLife.call(this)};h.prototype.HighlightControls=function(){x.call(this,true);if(t&&F){$(F.getRoot().ul).find(".siebui-task-assist-step-selected>li").focus()}t=false};function c(M){M.data.ctx.GetPM().OnControlEvent(v.get("TASKASSIST_PANE_CLOSE"))}function a(M){if(M.keyCode===$.ui.keyCode.ENTER){M.data.ctx.GetPM().OnControlEvent(v.get("TASKASSIST_PANE_CLOSE"))}}function z(M){F=undefined;M.data.ctx.GetPM().OnControlEvent(v.get("TASKASSIST_PANE_DONE"))}function k(M){if(M.keyCode===$.ui.keyCode.ENTER){F=undefined;M.data.ctx.GetPM().OnControlEvent(v.get("TASKASSIST_PANE_DONE"))}}function g(){if(this.GetPM().Get("Show")){x.call(this,true);if(!s){SiebelApp.EventManager.addListner("postload",this.HighlightControls,this);s=true}}else{x.call(this,false);if(s){SiebelApp.EventManager.removeListner("postload",this.HighlightControls,this);s=false}}}function H(){var M=this.GetPM().Get("TaskListName");$("#taskTitle_list").text(M)}function C(M){try{M.dynatree("getRoot").removeChildren()}catch(O){}var N=this;M.dynatree({title:N.GetPM().Get("TaskDetail").displayName,imagePath:"",onClick:function(Q,P){if(P.target.className==="dynatree-expander"){Q.expand(!Q.bExpanded);return false}return o.call(N,Q,P)}});F=M.dynatree("getTree");return M.dynatree("getRoot")}function o(Q,N){var R=this.GetPM();var M=Q.getLevel();var W=Q.data.key;if(M===2){if(W==="ShowMe"&&Q.data.href){window.open(Q.data.href,Q.data.target)}return false}if(M===3&&R.Get("TaskAdditionalItemMap")[W]){F=undefined;R.OnControlEvent("LaunchTaskFromList",W);return false}if(M===3||M===4){var O=(M===3)?Q:Q.parent;var X=O.data.key;var V=Number(X);var U=this.GetPM().Get("CurrentStepId");var P=Number(U);if(V!=P){var S=false;if(V===D){R.OnControlEvent("ExpandBranch",U);return false}if(V<P){if(R.OnControlEvent("ClearBranchAfter",X)){S=true}}if(!S){R.OnControlEvent("SetCurrentStepId",X);y.call(this,U,false);y.call(this,X,true)}}var T=R.Get("TaskDetail").stepArray;q.call(this,T[V-1],T[P-1]);return false}}function q(O,N){var M=SiebelApp.S_App.GetActiveView().GetName();if(O&&O.viewName&&O.viewName!==M){t=true;SiebelApp.S_App.GotoView(O.viewName)}else{p.call(this,N,false);p.call(this,O,true)}}function u(M,Q,S,T){var R=SiebelAppFacade.ComponentMgr.FindComponent({id:M});if(R){var U=R.Get("GetControls");var P=U[Q];if(P){var N=R.GetPR();if(N){var O=N.GetUIWrapper(P).GetEl();if(T){$(O).addClass(S)}else{$(O).removeClass(S)}}}}}function p(R,Q){if(R){if(!L.IsEmpty(R.highlightData)){var N=SiebelApp.S_App.GetActiveView().GetName();if(R.viewName===N){var S=R.highlightData.split("|");for(var P=0,M=S.length;P<M;P++){var O=S[P].split("@");u.call(this,O[0],O[1],"siebui-task-assist-control-highlight",Q)}}}}}function x(N){if(this.GetPM().Get("PlayerMode")==="1"){var O=Number(this.GetPM().Get("CurrentStepId"));if(O>=1){var M=this.GetPM().Get("TaskDetail").stepArray;if(M&&O<=M.length){p.call(this,M[O-1],N)}}}}function E(){var M=this.GetPM().Get("ClearCurrentStepControlsHighlight");if(M){this.GetPM().SetProperty("ClearCurrentStepControlsHighlight",false);x.call(this,false)}}function y(P,N){if(F&&P){var O=F.getNodeByKey(P);if(O){var M=$(O.parent.li).children("ul:first");if(N){M.removeClass().addClass("siebui-task-assist-step-selected");O.expand(true)}else{M.removeClass("siebui-task-assist-step-selected")}}}}function n(O){try{O.dynatree("getRoot").removeChildren()}catch(N){}var M=this;O.dynatree({title:M.GetPM().Get("TaskListName"),imagePath:"",onClick:function(Q,P){return A.call(M,Q,P)}});return O.dynatree("getRoot")}function A(O,N){var P=O.getLevel();var M=O.data.key;if(P===1){this.GetPM().OnControlEvent("LaunchTaskFromList",M)}else{if(P===2&&O.getParent()){this.GetPM().OnControlEvent("LaunchSubTaskFromList",M,O.getParent().data.key)}}return false}function J(N){var M=$("#"+N);if(!M.length){return}return M.dynatree("getRoot")}function e(){var R=$("#"+this.GetPM().Get("TaskListContainer"));if(!R.length){return}var N=n.call(this,R);var P=this.GetPM().Get("Tasks");if(P&&P.length&&N){for(var O=0,M=P.length;O<M;++O){m.call(this,P[O],N)}}var Q=$(N.ul);Q.find("a").attr("tabindex","-1");Q.attr("role","tree").attr("tabindex","-1").attr("aria-labelledby",w(taskTitle_list));r(Q)}function m(M,P){var N=P.addChild({title:M.taskName,isFolder:true,icon:"images/bullet_green.gif",expand:true,key:M.taskRowId,noLink:false});$(N.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",w(M.taskName));var O=M.subTask;if(O){N.addChild({title:O.taskName,key:O.taskRowId,noLink:false})}}function f(){var X=this.GetPM().Get("TaskDetail");var S=X.stepArray;var P=S.length;try{if(F){var O,U=0;while(U<P){O=F.getNodeByKey(U+1);if(O){S[U].isExpanded=O.bExpanded;
++U}else{break}}}}catch(V){}var R=$("#"+this.GetPM().Get("TaskContainer"));if(!R.length){return}var N=C.call(this,R);var M=N.addChild({title:X.displayName,isFolder:true,icon:false,expand:true,key:X.taskId,noLink:true,addClass:"siebui-task-assist-task-name"});var W=SiebelApp.S_App.GetPageURL().split("start.swe")[0]+v.get("ICON_EXPANDICON");if(S){for(var Q=0,T=S.length;Q<T;++Q){i.call(this,M,S[Q])}}if(X.hasDoneStep===false){B.call(this,M)}if(X.showMeObj){b.call(this,M,X.showMeObj)}if(X.addItemArray){I.call(this,M,X.addItemsHeader,X.addItemArray)}d.call(this);y.call(this,this.GetPM().Get("CurrentStepId"),true);var Y=$(M.li);Y.find("a").attr("tabindex","-1");Y.attr("role","tree").attr("tabindex","-1").attr("aria-label",w(X.displayName));r(Y);$("#taskListName").attr("role","link").attr("tabindex","0")}function i(O,P){if(!P){return}var U=P.sectionLabel?"siebui-task-assist-section-label":"siebui-task-assist-no-section-label";var S=O.addChild({title:P.sectionLabel,isFolder:true,icon:false,expand:true,noLink:true,addClass:U});var M=P.subStepArray;var N=S.addChild({title:P.number+". "+P.displayText,isFolder:true,icon:false,expand:P.isExpanded,key:P.number,noLink:true,addClass:M?"siebui-task-assist-has-substep":null});var V=P.sectionLabel+". "+P.number+". "+P.displayText;if(M){for(var R=0,T=M.length;R<T;R++){var Q=M[R];N.addChild({title:Q.displayText,icon:"images/task_bullet.gif",key:"sub"+Q.subStepId,noLink:false});V+=". "+(R+1)+". "+Q.displayText}}$(N.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",w(V))}function B(O){var N=O.addChild({title:"",isFolder:true,icon:false,expand:true,noLink:true,addClass:"siebui-task-assist-no-section-label"});var M=N.addChild({title:this.GetPM().Get("LocaleStringMap").IDS_TASKASST_BRANCH,icon:"images/arw_branch.gif",noLink:false,key:D,addClass:"siebui-task-assist-branch-step"});$(M.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",this.GetPM().Get("LocaleStringMap").IDS_TASKASST_BRANCH)}function b(O,M){if(!M){return}var N=O.addChild({title:M.displayText,href:M.location,target:"_blank",icon:false,noLink:true,key:"ShowMe",addClass:"siebui-task-assist-show-me"});$(N.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",w(M.displayText))}function I(S,T,N){var R=S.addChild({title:T,isFolder:true,icon:false,expand:true,noLink:true,addClass:"siebui-task-assist-additional-items"});$(R.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",w(T));for(var O=0,M=N.length;O<M;O++){var Q=N[O];var P=R.addChild({title:Q.name,icon:"images/bullet_green.gif",key:Q.rowId,noLink:false});$(P.li).attr("role","treeitem").attr("tabindex","-1").attr("aria-label",w(Q.name))}}function G(){var M=this.GetPM().Get("PlayerMode")==="1"?true:false;$("#tasklistUI").removeClass().addClass(M?"siebui-task-assist-hide":"siebui-task-assist-list");$("#taskPlayerUI").removeClass().addClass(M?"siebui-task-assist-player":"siebui-task-assist-hide");$("#titleBox_list").removeClass().addClass(M?"siebui-task-assist-hide":"siebui-task-assist-title");$("#titleBox_player").removeClass().addClass(M?"siebui-task-assist-title":"siebui-task-assist-hide")}function K(){var M=this.GetPM().Get("LocaleStringMap");for(var P in M){if(M.hasOwnProperty(P)){var N=M[P];var O=$("#"+P);if(O&&O.length){O.text(N)}}}}function d(){$("#taskListName").text(this.GetPM().Get("ReturnLinkName"))}function r(M){var N=M.find("li[role=treeitem]");N.keydown(function(O){return j(M,$(this),O)});N.off("focus").focus(function(O){return l(M,$(this),O)});if(F){M.find(".siebui-task-assist-step-selected>li").focus()}else{M.find("li:visible[role=treeitem]").first().focus()}}function j(S,P,R){var M=S.find("li:visible[role=treeitem]");var Q=M.index(P);S.find("a").attr("tabindex","-1");if((R.altKey||R.ctrlKey)||(R.shiftKey&&R.keyCode!=$.ui.keyCode.TAB)){return true}switch(R.keyCode){case $.ui.keyCode.UP:if(Q>0){var O=M.eq(Q-1);O.focus()}R.stopPropagation();return false;case $.ui.keyCode.DOWN:if(Q<M.length-1){var N=M.eq(Q+1);N.focus()}R.stopPropagation();return false;case $.ui.keyCode.ENTER:P.click();R.stopPropagation();return false}return true}function l(O,M,N){O.find("li").attr("tabindex","-1");M.attr("tabindex","0");return true}function w(N){var M=document.createElement("DIV");M.innerHTML=N;return M.textContent||M.innerText||""}return h}());return SiebelAppFacade.TaskAssistPlayerPR})};